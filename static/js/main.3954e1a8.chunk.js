(this["webpackJsonpset-solver"]=this["webpackJsonpset-solver"]||[]).push([[0],{136:function(e,n){},138:function(e,n){},148:function(e,n){},150:function(e,n){},175:function(e,n){},176:function(e,n){},181:function(e,n){},183:function(e,n){},190:function(e,n){},209:function(e,n){},235:function(e,n,t){"use strict";t.r(n);var a,i,o,r,c,s,u,h,d=t(2),l=t.n(d),f=t(122),p=t.n(f),v=t(11),g=t(0),b=t.n(g),m=t(37),O=t(25),j=t(26),x=function(e){return Math.sqrt(Math.pow(e.x,2)+Math.pow(e.y,2))},w=function(e,n){return new b.a.Point(e.x-n.x,e.y-n.y)},y=function(e,n){return new b.a.Point(e.x+n.x,e.y+n.y)},S=function(){function e(n){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(O.a)(this,e),this.shapeType=void 0,this.shapes=void 0,this.shapeType=n,this.shapes=t}return Object(j.a)(e,[{key:"shapeCount",value:function(){return this.shapes.length}},{key:"mid",value:function(){var e,n=new b.a.Point(0,0),t=Object(m.a)(this.shapes);try{for(t.s();!(e=t.n()).done;){var a=e.value;n=y(n,a.minRect.center)}}catch(i){t.e(i)}finally{t.f()}return n=function(e,n){var t=e.x,a=e.y;return new b.a.Point(t*n,a*n)}(n,1/this.shapes.length)}}]),e}(),C=t(38),M=t(237),E=function(){function e(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;Object(O.a)(this,e),this.shape=void 0,this.colour=void 0,this.shading=void 0,this.shape=n,this.colour=t,this.shading=a}return Object(j.a)(e,[{key:"setShapeType",value:function(e){this.shape=e<.666?"DIAMOND":e<.81?"SQUIGGLE":"OVAL"}},{key:"setShapeColour",value:function(e){var n=e[0];this.colour=n>=340||n<=15?"RED":n>=240&&n<=300?"PURPLE":n>=60&&n<=180?"GREEN":"PURPLE"}},{key:"setShapeShading",value:function(e,n){var t=n[2]-e[2];this.shading=t<=4?"OPEN":t<21?"STRIPED":"SOLID"}},{key:"equals",value:function(e){return this.colour===e.colour&&this.shading===e.shading&&this.shape===e.shape}},{key:"toString",value:function(){return"".concat(this.colour," ").concat(this.shading," ").concat(this.shape)}}]),e}(),R=function(e,n){for(var t=e.data32S.length,a=new b.a.Mat(t/2,2,b.a.CV_32S),i=T(e,0),o=T(e,2),r=T(e,4),c=6;c<t+6;c+=2){var s=L(i,r);if(0!==s[0]||0!==s[1]){var u=k(s);a.data32S[c%t]=Math.floor(o[0]+n*u[0]),a.data32S[(c+1)%t]=Math.floor(o[1]+n*u[1])}i=o,o=r,r=T(e,c%t)}return a},T=function(e,n){return[e.data32S[n],e.data32S[n+1]]},k=function(e){var n=Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2));return[e[1]/n,-e[0]/n]},L=function(e,n){return[n[0]-e[0],n[1]-e[1]]},I=t(123),_=t.n(I),z=[255,255,255,255],A=[0,0,0,255],P=[[255,0,255,255],[255,0,0,255],[0,255,0,255],[0,0,255,255],[255,128,0,255],[0,255,255,255]],N=function(e){return _.a.rgb.hsl(Object(C.unsafeCoerce)(e))},U=function(){function e(n,t,a){Object(O.a)(this,e),this.shapeType=void 0,this.minRect=void 0,this.minLength=void 0,this.contour=void 0,this.childContour=void 0,this.parentContour=void 0,this.invalid=void 0,this.meanContour=void 0,this.meanInside=void 0,this.meanOutside=void 0,this.extent=void 0,this.id=void 0;var i=t.size,o=i.width,r=i.height,c=Math.min(o,r);this.id=Object(M.a)(),this.minRect=t,this.minLength=Math.min(t.size.width,t.size.height),this.contour=n,this.childContour=R(n,-.1*c),this.parentContour=R(n,.2*c),this.shapeType=new E,this.invalid=!1,this.extent=a}return Object(j.a)(e,[{key:"setShape",value:function(){this.meanContour&&this.meanInside&&this.meanOutside&&(this.shapeType.setShapeType(this.extent),this.shapeType.setShapeColour(N(this.meanContour)),this.shapeType.setShapeShading(N(this.meanInside),N(this.meanOutside)))}},{key:"validateBounds",value:function(e){var n=e.size(),t=n.width,a=n.height,i=b.a.boundingRect(this.parentContour);this.invalid=i.x<0||i.x+i.width>=t||i.y<0||i.y+i.height>=a}},{key:"calculateMeans",value:function(e){var n=new b.a.MatVector;n.push_back(this.childContour),n.push_back(this.contour),n.push_back(this.parentContour);var t=b.a.boundingRect(this.parentContour),a=new b.a.Point(-t.x,-t.y),i=e.roi(t),o=i.size(),r=b.a.Mat.zeros(o.height,o.width,b.a.CV_8U);b.a.drawContours(r,n,0,z,-1,b.a.LINE_8,new b.a.Mat,0,a),this.meanInside=b.a.mean(i,r),b.a.drawContours(r,n,1,z,-1,b.a.LINE_8,new b.a.Mat,0,a),b.a.drawContours(r,n,0,A,-1,b.a.LINE_8,new b.a.Mat,0,a),this.meanContour=b.a.mean(i,r),b.a.drawContours(r,n,2,z,-1,b.a.LINE_8,new b.a.Mat,0,a),b.a.drawContours(r,n,1,A,-1,b.a.LINE_8,new b.a.Mat,0,a),this.meanOutside=b.a.mean(i,r),i.delete(),r.delete(),n.delete();var c=N(this.meanInside),s=N(this.meanOutside);this.invalid=c[2]-s[2]>10}},{key:"adjustWhiteBalance",value:function(e){var n=Object(v.a)(e,3),t=n[0],a=n[1],i=n[2];this.meanContour&&(this.meanContour[0]-=t,this.meanContour[1]-=a,this.meanContour[2]-=i)}}]),e}(),B=function(e){var n=function(e){var n=new b.a.Mat,t=new b.a.Mat;return b.a.GaussianBlur(e,n,new b.a.Size(5,5),b.a.BORDER_DEFAULT),b.a.cvtColor(n,t,b.a.COLOR_BGR2GRAY),n.delete(),t}(e),t=function(e){var n=new b.a.Mat,t=new b.a.MatVector,a=new b.a.Mat;return b.a.adaptiveThreshold(e,n,255,b.a.ADAPTIVE_THRESH_GAUSSIAN_C,b.a.THRESH_BINARY,7,2),b.a.findContours(n,t,a,b.a.RETR_TREE,b.a.CHAIN_APPROX_SIMPLE),n.delete(),a.delete(),t}(n),a=D(t,e),i=V(a);return n.delete(),t.delete(),i},D=function(e,n){for(var t=n.size(),a=Math.min(t.width,t.height),i=.04*a,o=.03*a,r=.025*a,c=.19*a,s=[],u=Object(C.unsafeCoerce)(e.size()),h=0;h<u;h++){var d=e.get(h);if(!(d.data32S.length<i)){var l=b.a.boundingRect(d);if(!(l.width<o&&l.height<o)){var f=b.a.minAreaRect(d),p=f.size,v=p.width,g=p.height;if(!(v<r||g<r)&&!(v>c&&g>c)&&H(v,g)){var m=b.a.contourArea(d)/(v*g);if(!(m<.55)&&!(m>.9)){var O=new U(d,f,m);O.validateBounds(n),O.invalid||O.calculateMeans(n),O.invalid||s.push(O)}}}}}var j=G(s);return s.forEach((function(e){e.adjustWhiteBalance(j),e.setShape()})),s},G=function(e){var n=e.reduce((function(e,n){var t,a,i,o,r,c,s=Object(v.a)(e,3),u=s[0],h=s[1],d=s[2];return[u+(null!==(t=null===(a=n.meanOutside)||void 0===a?void 0:a[0])&&void 0!==t?t:0),h+(null!==(i=null===(o=n.meanOutside)||void 0===o?void 0:o[1])&&void 0!==i?i:0),d+(null!==(r=null===(c=n.meanOutside)||void 0===c?void 0:c[2])&&void 0!==r?r:0)]}),[0,0,0]),t=Object(v.a)(n,3),a=t[0],i=t[1],o=t[2],r=a/e.length,c=i/e.length,s=o/e.length,u=(r+c+s)/3;return[r-u,c-u,s-u]},H=function(e,n){var t=e>n?e/n:n/e;return t>1.3&&t<3.2},V=function(e){return e.filter((function(n){return e.every((function(e){if(n===e)return!0;var t=n.contour.data32S[0],a=n.contour.data32S[1];return!(b.a.pointPolygonTest(e.contour,new b.a.Point(t,a),!1)>0)}))}))},q=function(e,n,t){var a,i=Object(m.a)(e);try{for(i.s();!(a=i.n()).done;){var o=a.value;if(o.shapes.includes(n))return void o.shapes.push(t);if(o.shapes.includes(t))return void o.shapes.push(n)}}catch(r){i.e(r)}finally{i.f()}e.push(new S(n.shapeType,[n,t]))},Y=function(e){return function(e){for(var n,t,a=[],i=[],o=0;o<e.length;o++){for(var r=e[o],c=a.includes(r),s=o+1;s<e.length;s++){var u=e[s];if(u.shapeType.equals(r.shapeType)){var h=(n=r.minRect.center,t=u.minRect.center,Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2));Math.sqrt(h)<1.75*Math.max(r.minLength,u.minLength)&&(a.push(u),q(i,r,u),c=!0)}}c||i.push(new S(r.shapeType,[r]))}return i}(B(e))},F=function(e){var n=new Set,t=new Set,a=new Set,i=new Set;return e.forEach((function(e){n.add(e.shapeType.colour),t.add(e.shapeType.shape),a.add(e.shapeType.shading),i.add(e.shapeCount())})),n.size%2===1&&t.size%2===1&&a.size%2===1&&i.size%2===1},X=function(e,n,t,a,i){var o=e.mid(),r=n.mid();b.a.circle(t,o,2*i,a,-1,b.a.LINE_AA),b.a.circle(t,r,2*i,a,-1,b.a.LINE_AA),b.a.line(t,o,r,a,i,b.a.LINE_AA)},J=function(e,n){var t,a,i,o,r,c,s=n.minRect.center;b.a.circle(e,s,2*n.minLength/3,n.meanContour,-1),b.a.circle(e,s,n.minLength/2,n.meanInside,-1);var u="".concat(null!==(t=null===(a=n.shapeType.colour)||void 0===a?void 0:a[0])&&void 0!==t?t:"?").concat(null!==(i=null===(o=n.shapeType.shape)||void 0===o?void 0:o[0].toUpperCase())&&void 0!==i?i:"?").concat(null!==(r=null===(c=n.shapeType.shading)||void 0===c?void 0:c.slice(0,2))&&void 0!==r?r:"??"),h=y(function(e){var n=e.x,t=e.y;return new b.a.Point(n,t)}(s),{x:-20,y:5});b.a.putText(e,u,h,b.a.FONT_HERSHEY_SIMPLEX,.5,A,1,b.a.LINE_AA)},W=t(12),Q=t(13),K=Q.a.div(a||(a=Object(W.a)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  max-height: min(calc(100vh - 160px), calc(100% - 24px));\n  max-width: calc(min(100%, 100vw) - 24px);\n"]))),Z=Q.a.img(i||(i=Object(W.a)(["\n  display: none;\n"]))),$=Q.a.canvas(o||(o=Object(W.a)(["\n  border-radius 10px;\n  max-width: calc(100% - 24px);\n  max-height: calc(100% - 24px);\n"]))),ee=Q.a.button(r||(r=Object(W.a)(["\n  background-image: linear-gradient(\n    to right,\n    #314755 0%,\n    #26a0da 51%,\n    #314755 100%\n  );\n  padding: 15px 45px;\n  text-align: center;\n  text-transform: uppercase;\n  transition: 0.5s;\n  background-size: 200% auto;\n  color: white;\n  box-shadow: 0 0 20px #eee;\n  border-radius: 10px;\n  display: block;\n  font-size: 16px;\n  border: 0;\n\n  &:hover {\n    background-position: right center;\n    text-decoration: none;\n    box-shadow: 0 0 0px #eee;\n  }\n"]))),ne=t(5),te=function(e){var n=e.imageUrl,t=Object(d.useState)(!1),a=Object(v.a)(t,2),i=a[0],o=a[1],r=Object(d.useState)(!1),c=Object(v.a)(r,2),s=c[0],u=c[1],h=Object(d.useState)([]),l=Object(v.a)(h,2),f=l[0],p=l[1],g=Object(d.useState)(),m=Object(v.a)(g,2),O=m[0],j=m[1],y=Object(d.useRef)(null),S=Object(d.useRef)(null);Object(d.useEffect)((function(){o(!1),j(void 0),p([]),u(!1)}),[n]),Object(d.useEffect)((function(){if(S.current&&i){var e=function(e){var n=e.size(),t=n.width,a=n.height,i=Math.floor(Math.max(t,a)/1e3),o=new b.a.Mat;return i>1?(b.a.resize(e,o,new b.a.Size(Math.floor(t/i),Math.floor(a/i))),e.delete(),o):e}(b.a.imread(S.current)),n=Y(e);p(n),j(e)}}),[S,i]),Object(d.useEffect)((function(){if(i&&f&&y.current&&O){var e=O.clone();if(s)f.forEach((function(n,t){n.shapes.forEach((function(n){J(e,n)}))}));else(function(e){for(var n=[],t=0;t<=e.length-3;t++)for(var a=t+1;a<=e.length-2;a++)for(var i=a+1;i<=e.length-1;i++)F([e[t],e[a],e[i]])&&n.push([e[t],e[a],e[i]]);return n})(f).forEach((function(n,t){!function(e,n,t){var a=n[0].mid(),i=n[1].mid(),o=n[2].mid(),r=x(w(a,i)),c=x(w(i,o)),s=x(w(o,a));r<c?(X(n[0],n[1],e,t,3),c<s?X(n[1],n[2],e,t,3):X(n[2],n[0],e,t,3)):(X(n[1],n[2],e,t,3),r<s?X(n[0],n[1],e,t,3):X(n[2],n[0],e,t,3))}(e,n,P[t])}));b.a.imshow(y.current,e)}}),[i,y,O,f,s]);return Object(ne.jsxs)(ne.Fragment,{children:[Object(ne.jsxs)(K,{children:[Object(ne.jsx)(Z,{src:n,onLoad:function(e){o(!0)},ref:S,alt:"Original Image"}),Object(ne.jsx)($,{ref:y,onClick:function(e){if(y.current){var n=y.current.clientTop+y.current.offsetTop,t=y.current.clientLeft+y.current.offsetLeft,a=e.pageX-t,i=e.pageY-n,o=f.flatMap((function(e){return e.shapes}));o.sort((function(e,n){return x(w({x:a,y:i},e.minRect.center))<x(w({x:a,y:i},n.minRect.center))?-1:1})),console.log(o[0])}}})]}),O&&f&&Object(ne.jsx)(ee,{onClick:function(){return u(!s)},children:s?"Show Sets":"Show Debug"})]})},ae=Q.a.div(c||(c=Object(W.a)([""]))),ie=Q.a.button(s||(s=Object(W.a)(["\n  background-image: linear-gradient(\n    to right,\n    #ff512f 0%,\n    #f09819 51%,\n    #ff512f 100%\n  );\n  padding: 15px 45px;\n  text-align: center;\n  text-transform: uppercase;\n  transition: 0.5s;\n  background-size: 200% auto;\n  color: white;\n  box-shadow: 0 0 20px #eee;\n  border-radius: 10px;\n  display: block;\n  font-size: 16px;\n  border: 0;\n\n  &:hover {\n    background-position: right center;\n    text-decoration: none;\n    box-shadow: 0 0 0px #eee;\n  }\n"]))),oe=Q.a.input(u||(u=Object(W.a)(["\n  display: none;\n"]))),re=function(e){var n=e.onUpload,t=Object(d.useRef)(null),a=Object(d.useCallback)((function(e){var t,a=null!==(t=e.target.files)&&void 0!==t?t:[];a.length>0&&n(URL.createObjectURL(a[0]))}),[n]);return Object(ne.jsxs)(ae,{children:[Object(ne.jsx)(oe,{ref:t,id:"file",type:"file",accept:"image/*",onChange:a}),Object(ne.jsx)(ie,{onClick:function(){var e;return null===(e=t.current)||void 0===e?void 0:e.click()},children:"Upload Image"})]})},ce=Q.a.div(h||(h=Object(W.a)(["\n  display: flex;\n  flex-direction: column;\n  height: 100%;\n  width: 100vw;\n  align-items: center;\n  justify-content: center;\n  background: #f3f3f3;\n"]))),se=function(){var e=Object(d.useState)(),n=Object(v.a)(e,2),t=n[0],a=n[1];return Object(ne.jsxs)(ce,{children:[Object(ne.jsx)(re,{onUpload:function(e){return a(e)}}),t&&Object(ne.jsx)(te,{imageUrl:t})]})};p.a.render(Object(ne.jsx)(l.a.StrictMode,{children:Object(ne.jsx)(se,{})}),document.getElementById("root"))}},[[235,1,2]]]);
//# sourceMappingURL=main.3954e1a8.chunk.js.map